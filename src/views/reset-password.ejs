<%- include('partials/header', { title: 'Reset Password' }) %>
  <section class="panel">
    <div class="panel-header">
      <div>
        <p class="eyebrow">Account recovery</p>
        <h1>Reset password</h1>
      </div>
      <a href="/login" class="ghost">Back to login</a>
    </div>
    <% if (error) { %>
      <div class="alert danger"><%= error %></div>
    <% } %>
    <% if (success) { %>
      <div class="alert success"><%= success %></div>
      <a href="/login" class="primary">Go to login</a>
    <% } else { %>
      <p class="muted">Enter the 6-digit code from your email and choose a new password.</p>
      <form action="/reset-password" method="POST" class="stack">
        <label class="field">
          <span>Email</span>
          <input type="email" name="email" value="<%= email || '' %>" required autocomplete="email">
        </label>
        <label class="field">
          <span>Reset code</span>
          <input type="text" name="code" inputmode="numeric" pattern="[0-9]*" maxlength="6" placeholder="123456" required autocomplete="off">
        </label>
        <label class="field">
          <span>New password</span>
          <input type="password" name="password" required autocomplete="new-password" minlength="6">
        </label>
        <label class="field">
          <span>Confirm password</span>
          <input type="password" name="confirm_password" required autocomplete="new-password" minlength="6">
        </label>
        <button type="submit" class="primary">Reset password</button>
      </form>
      <p class="muted small">Don't have a code? <a href="/forgot-password">Request one here</a>.</p>
    <% } %>
  </section>
<%- include('partials/footer') %>
